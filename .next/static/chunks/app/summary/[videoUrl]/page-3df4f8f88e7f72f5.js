(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[342],{3441:(e,t,r)=>{Promise.resolve().then(r.bind(r,4384))},4384:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(95155),s=r(12115),n=r(76046),l=r(32274),i=r(35007),c=r(39286),o=r(13920),d=r(68131),u=r(50972),m=r(60252),g=r(10319),h=r(10142),x=r(94206);function p(e){var t;let{params:r}=e,[p,f]=(0,s.useState)({content:""}),[y,v]=(0,s.useState)(null),[j,b]=(0,s.useState)(!0),[N,w]=(0,s.useState)(null),[S,C]=(0,s.useState)({currentChunk:0,totalChunks:0,stage:"analyzing",message:"Analyzing video content..."}),k=(0,n.useSearchParams)(),z=k.get("lang")||"en",F=k.get("mode")||"video",T=k.get("model")||"gemini",{videoUrl:E}=(0,s.use)(r);(0,s.useEffect)(()=>{(async()=>{try{var e;b(!0),w(null);let t=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=t.length%4;return atob(r?t+"=".repeat(4-r):t)}(E),r=await fetch("/api/summarize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t,language:z,mode:F,aiModel:T})});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to generate summary")}let a=null===(e=r.body)||void 0===e?void 0:e.getReader();if(!a)throw Error("Failed to read response stream");let s=new TextDecoder;for(;;){let{done:e,value:t}=await a.read();if(e)break;let r=s.decode(t);try{let e=JSON.parse(r);if("progress"===e.type)C({currentChunk:e.currentChunk,totalChunks:e.totalChunks,stage:e.stage,message:e.message});else if("complete"===e.type){f({content:e.summary,title:e.title||"YouTube ".concat("podcast"===F?"Podcast":"Video"," Summary")}),v(e.source);break}}catch(e){console.error("Error parsing chunk:",e)}}}catch(e){console.error("Error fetching summary:",e),w(e instanceof Error?e.message:"An error occurred while generating the summary")}finally{b(!1)}})()},[E,z,F,T]);let P=(null===(t=Object.entries(l.cb).find(e=>{let[t,r]=e;return r===z}))||void 0===t?void 0:t[0])||"English",D=()=>{switch(y){case"youtube":return"YouTube subtitles";case"cache":return"Cached summary";default:return""}};if(j){let e=S.totalChunks?S.currentChunk/S.totalChunks*100:0;return(0,a.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:(0,a.jsxs)(i.Zp,{className:"w-full max-w-4xl",children:[(0,a.jsxs)(i.aR,{children:[(0,a.jsx)(i.ZB,{className:"text-2xl font-bold",children:"Generating Summary"}),(0,a.jsx)(i.BT,{children:"Please wait while we process your video"})]}),(0,a.jsx)(i.Wu,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,a.jsx)("span",{children:S.message}),(0,a.jsxs)("span",{children:[Math.round(e),"%"]})]}),(0,a.jsx)("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-primary rounded-full transition-all duration-500",style:{width:"".concat(e,"%")}})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("analyzing"===S.stage?"bg-primary animate-pulse":"bg-muted")}),(0,a.jsx)("span",{className:"analyzing"===S.stage?"text-primary":"text-muted-foreground",children:"Analyzing video content"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("processing"===S.stage?"bg-primary animate-pulse":"bg-muted")}),(0,a.jsxs)("span",{className:"processing"===S.stage?"text-primary":"text-muted-foreground",children:["Processing chunks (",S.currentChunk,"/",S.totalChunks,")"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("finalizing"===S.stage?"bg-primary animate-pulse":"bg-muted")}),(0,a.jsx)("span",{className:"finalizing"===S.stage?"text-primary":"text-muted-foreground",children:"Creating final summary"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("saving"===S.stage?"bg-primary animate-pulse":"bg-muted")}),(0,a.jsx)("span",{className:"saving"===S.stage?"text-primary":"text-muted-foreground",children:"Saving to history"})]})]})]})})]})})}return(0,a.jsxs)("div",{className:"min-h-screen bg-background flex flex-col items-center p-4",children:[(0,a.jsxs)(i.Zp,{className:"w-full max-w-4xl mb-4",children:[(0,a.jsx)(i.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(i.ZB,{className:"flex items-center",children:["podcast"===F?(0,a.jsx)(u.A,{className:"mr-2"}):(0,a.jsx)(m.A,{className:"mr-2"}),(0,a.jsx)("span",{className:"text-2xl font-bold",children:"podcast"===F?"Podcast-Style Summary":"Video Summary"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(c.E,{variant:"secondary",children:P}),y&&(0,a.jsxs)(c.E,{variant:"outline",className:"flex items-center",children:[(()=>{switch(y){case"youtube":return(0,a.jsx)(o.A,{className:"h-4 w-4"});case"cache":return(0,a.jsx)(d.A,{className:"h-4 w-4"});default:return null}})(),(0,a.jsx)("span",{className:"ml-1",children:D()})]})]})]})}),(0,a.jsxs)(i.Wu,{children:[N&&(0,a.jsx)("div",{className:"bg-destructive/15 text-destructive px-4 py-3 rounded-md",children:N}),!j&&!N&&(0,a.jsx)("div",{className:"prose prose-sm sm:prose lg:prose-lg max-w-none dark:prose-invert",children:(0,a.jsx)(x.o,{children:p.content})})]})]}),!j&&!N&&(0,a.jsxs)("button",{onClick:()=>{try{let e=new h.uE({orientation:"portrait",unit:"mm",format:"a4",compress:!0}),t=15,r=e.internal.pageSize.getWidth(),a=r-30;e.setFont("helvetica","normal"),e.setTextColor(40,40,40),e.setFontSize(20),e.setFont("helvetica","bold");let s=p.title||"".concat("podcast"===F?"Podcast":"Video"," Summary"),n=e.splitTextToSize(s,a);e.text(n,15,t),e.setDrawColor(200,200,200),e.line(15,t+2,15+e.getTextWidth(n.join(" ")),t+2),t+=6*n.length+12,e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(100,100,100);let l=["Language: ".concat(P),"Source: ".concat(D()),"Generated: ".concat(new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))];e.text(l.join(" • "),15,t),t+=12,e.setDrawColor(220,220,220),e.line(15,t,r-15,t),t+=12,e.setFontSize(11),e.setTextColor(50,50,50);let i=p.content.replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/`{3}[\s\S]*?`{3}/g,"").replace(/`(.*?)`/g,"$1").replace(/\[(.*?)\]\(.*?\)/g,"$1").replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"").replace(/\n{3,}/g,"\n\n");(r=>{r.split(/\n\s*\n/).filter(e=>e.trim().length>0).forEach(r=>{if(!(r=r.trim()))return;if(r.startsWith("## ")){e.setFontSize(14),e.setFont("helvetica","bold");let s=r.replace(/^#+\s*/,""),n=e.splitTextToSize(s,a);t+6*n.length>e.internal.pageSize.getHeight()-15&&(e.addPage(),t=15),e.text(n,15,t),t+=6*n.length+4,e.setFontSize(11),e.setFont("helvetica","normal");return}if(r.startsWith("• ")||r.startsWith("- ")||r.match(/^\d+\./)){r.split("\n").forEach(r=>{r=r.replace(/^[•\-]\s+/,"• ").replace(/^\d+\./,"•");let s=e.splitTextToSize(r,a-5);t+6*s.length>e.internal.pageSize.getHeight()-15&&(e.addPage(),t=15),e.text(s,20,t),t+=6*s.length+2}),t+=2;return}let s=e.splitTextToSize(r,a);t+6*s.length>e.internal.pageSize.getHeight()-15&&(e.addPage(),t=15),e.text(s,15,t),t+=6*s.length+8})})(i),e.setFontSize(9),e.setTextColor(150,150,150),e.text("Generated by YouTube AI Summarizer • Page ".concat(e.getNumberOfPages()),15,e.internal.pageSize.getHeight()-10);let c=s.replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_").toLowerCase(),o=new Date().toISOString().replace(/[:.]/g,"-"),d="".concat(c,"_summary_").concat(o,".pdf");e.save(d)}catch(e){console.error("Error generating PDF:",e),alert("Failed to generate PDF. Please try again.")}},className:"flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:[(0,a.jsx)(g.A,{className:"h-4 w-4"}),"Download PDF"]})]})}},39286:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var a=r(95155);r(12115);var s=r(31027),n=r(29602);let l=(0,s.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:r}),t),...s})}},35007:(e,t,r)=>{"use strict";r.d(t,{BT:()=>o,Wu:()=>d,ZB:()=>c,Zp:()=>l,aR:()=>i});var a=r(95155),s=r(12115),n=r(29602);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow transition-all duration-300",r),...s})});l.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",r),...s})});c.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});o.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},29602:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(43463),s=r(69795);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},32274:(e,t,r)=>{"use strict";r.d(t,{cb:()=>a});let a={English:"en"}}},e=>{var t=t=>e(e.s=t);e.O(0,[930,85,776,567,441,517,358],()=>t(3441)),_N_E=e.O()}]);